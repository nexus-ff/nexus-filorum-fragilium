<!DOCTYPE html>
<html lang="de">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>nexus filorium fragilium</title>

  <style>
    :root {
      --fg: #000;
      --bg: #fff;
      --accent: #000;
      --mono: "Courier New", "Lucida Console", ui-monospace, monospace;

      --input-bg: #1a1a1a;      /* sehr dunkles Grau */
      --input-text: #cccccc;    /* hellgrau */
    }

    html, body { height:100%; margin:0; padding:0; }
    body {
      background: var(--bg);
      color: var(--fg);
      font-family: var(--mono);
      overflow-x: hidden;
    }

    .container {
      max-width: 640px;
      margin: 0 auto;
      padding: 16px;
      display: flex;
      flex-direction: column;
      align-items: center;
      gap: 16px;
      min-height: 100dvh;
      box-sizing: border-box;
    }

    /* ===== Typewriter ===== */
    #typewriter {
      white-space: pre-wrap;
      text-align: center;
      font-size: 1.1rem;
      line-height: 1.4;
      max-width: 100%;
      word-break: break-word;
      overflow-wrap: anywhere;
    }

    #cursor {
      display: inline-block;
      animation: blink .7s step-end infinite;
    }
    @keyframes blink { 50% { opacity:0; } }

    /* ===== Pfeil ===== */
    #arrow {
      width: 2px;
      background: #000;
      height: 160px;
      margin-top: 10px;
      position: relative;
    }
    #arrow::after {
      content: "";
      position: absolute;
      bottom: -8px;
      left: 50%;
      transform: translateX(-50%);
      border-left: 6px solid transparent;
      border-right: 6px solid transparent;
      border-top: 10px solid #000;
    }

    /* ===== Login-Bereich ===== */
    .controls {
      display: flex;
      flex-direction: column;
      align-items: center;
      gap: 10px;
      padding-top: 20px;
    }

    input[type="password"] {
      padding: 10px 12px;
      background: var(--input-bg);
      color: var(--input-text);
      border: 2px solid #000;
      border-radius: 6px;
      font-size: 16px;
    }
    input::placeholder {
      color: #888;
    }
    input:focus {
      outline: 2px solid #000;
    }

    button {
      padding: 10px 12px;
      background: #000;
      color: #fff;
      border: 2px solid #000;
      border-radius: 6px;
      cursor: pointer;
      font-size: 16px;
    }

    /* Fehlermeldung */
    #errorMessage {
      color: #b00020;
      height: 1.4em;
      text-align:center;
      font-size:.95rem;
    }

    /* ===== Geschützter Inhalt ===== */
    #content {
      display:none;
      font-size: .95rem;
      line-height: 1.45;
      white-space: pre-wrap;
      word-break: break-word;
      overflow-wrap: anywhere;
      padding-top: 20px;
    }

    img {
      display: block;
      margin: 16px auto 0;
      width: 100%;
      max-width: 320px;
      border: 2px solid #000;
      border-radius: 10px;
      cursor: pointer;
      transition: .2s;
    }
    img:hover { transform: scale(1.03); }
  </style>
</head>

<body>
  <div class="container">

    <!-- TYPEWRITER -->
    <div id="typewriter">
      <span id="typed-text"></span><span id="cursor">|</span>
    </div>

    <!-- PFEIL (bis Login erfolgreich) -->
    <div id="arrow"></div>

    <!-- LOGIN -->
    <div class="controls" id="loginControls">
      <input id="passwordInput" type="password" placeholder="Введи пароль..." />
      <button id="loginBtn">Войти</button>
      <div id="errorMessage"></div>
    </div>

    <!-- INHALT -->
    <div id="content">

<h2>Не рви — а распутывай</h2>

<em><strong>НИТИ</strong>

… (DEIN TEXT BLEIBT UNVERÄNDERT)
</em>

<img id="mainImage" src="image/IMG_8462.JPG" alt="Bild 1">

    </div>
  </div>

<script>
/* ===========================
   MULTILINE TYPEWRITER
=========================== */

const lines = [
  "Их много,",
  "они сплетены",
  "и норовят порваться.",
  "Не рви их."
];

const typedText = document.getElementById("typed-text");
const cursor = document.getElementById("cursor");
let lineIndex = 0, charIndex = 0;

function randomDelay() { return Math.floor(Math.random()*120)+40; }

function typeWriter() {
  if (lineIndex >= lines.length) return;

  const line = lines[lineIndex];

  if (charIndex < line.length) {
    typedText.textContent += line[charIndex++];
    setTimeout(typeWriter, randomDelay());
  } else {
    if (lineIndex < lines.length - 1) typedText.textContent += "\n";
    lineIndex++; charIndex = 0;
    if (lineIndex < lines.length) setTimeout(typeWriter, 350);
  }
}

typeWriter();

/* ===========================
   LOGIN / PASSWORT
=========================== */

const correctPassword = "нити";
const errorBox = document.getElementById("errorMessage");

function showError(msg) {
  errorBox.innerHTML = msg;
}

function checkPassword() {
  const input = document.getElementById("passwordInput").value.trim();
  if (input === correctPassword) {
    document.getElementById("content").style.display = "block";
    document.getElementById("loginControls").style.display = "none";
    document.getElementById("arrow").style.display = "none"; // Pfeil weg
    showError("");

    sendVisitNotification();
  } else {
    showError("❌ Неверный пароль<br>русскими, маленькими буквами");
    const inp = document.getElementById("passwordInput");
    inp.value = "";
    inp.focus();
  }
}

document.getElementById("loginBtn").onclick = checkPassword;
document.getElementById("passwordInput").addEventListener("keydown", e => {
  if (e.key === "Enter") checkPassword();
});

/* ===========================
   BILDER-WECHSEL
=========================== */

const img = document.getElementById("mainImage");
let toggled = false;

img.addEventListener("mouseenter", () => {
  img.src = "image/IMG_20251029_213356_289.jpg";
});

img.addEventListener("mouseleave", () => {
  if (!toggled) img.src = "image/IMG_8462.JPG";
});

img.addEventListener("click", () => {
  toggled = !toggled;
  img.src = toggled
    ? "image/IMG_20251029_213356_289.jpg"
    : "image/IMG_8462.JPG";
});

/* ===========================
   TELEGRAM-NOTIFY
=========================== */
function sendVisitNotification() {
  fetch("/api/notify", { method: "POST" });
}
</script>

</body>
</html>
